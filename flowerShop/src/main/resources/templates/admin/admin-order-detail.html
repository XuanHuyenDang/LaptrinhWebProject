<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Chi tiết đơn hàng - Florio Admin</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
	rel="stylesheet">
<style>
body {
	background-color: #fffafc;
	font-family: "Segoe UI", sans-serif;
}

/* Sidebar */
.sidebar {
	position: fixed;
	top: 0;
	left: 0;
	height: 100vh;
	width: 250px;
	background: linear-gradient(180deg, #ffb6c1 0%, #ffe5ec 100%);
	color: #4a4a4a;
	padding-top: 1rem;
	box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
}

.sidebar h5 {
	font-weight: bold;
	color: #c2185b;
}

.sidebar a {
	color: #5a5a5a;
	text-decoration: none;
	display: block;
	padding: 10px 20px;
	border-radius: 8px;
	margin: 3px 10px;
	transition: all 0.3s ease;
	font-weight: 500;
}

.sidebar a:hover, .sidebar a.active {
	background: #fff;
	color: #c2185b;
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
	transform: translateX(3px);
}

.sidebar i {
	color: #c2185b;
}

main {
	margin-left: 270px;
	padding: 30px;
}

.card {
	border-radius: 15px;
	border: none;
	box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
}

h3, h5 {
	color: #c2185b;
	font-weight: 700;
}

.info-group p {
	margin-bottom: 0.8rem;
	font-size: 1rem;
}

.info-group p strong {
	display: inline-block;
	width: 150px;
	color: #555;
}
</style>
</head>
<body>

	<nav class="sidebar">
		<h5 class="text-center">
			<i class="bi bi-flower1 me-1"></i> Florio Admin
		</h5>
		<hr class="text-muted">
		<a th:href="@{/admin/dashboard}"><i
			class="bi bi-speedometer2 me-2"></i> Tổng quan </a> <a
			th:href="@{/admin/categories}"> <i class="bi bi-list-ul me-2"></i>
			Danh mục
		</a> <a th:href="@{/admin/orders}" class="active"> <i
			class="bi bi-cart4 me-2"></i> Đơn hàng
		</a> <a th:href="@{/admin/customers}"> <i class="bi bi-people me-2"></i>
			Khách hàng
		</a> <a th:href="@{/admin/comments}"> <i
			class="bi bi-chat-left-text me-2"></i> Bình luận
		</a>
		<hr class="text-muted">
		<form th:action="@{/auth/logout}" method="post">
			<button type="submit" class="btn btn-outline-danger">
				<i class="bi bi-box-arrow-right"></i> Đăng xuất
			</button>
		</form>
	</nav>

	<main>
		<div class="d-flex align-items-center justify-content-between mb-4">
			<h3>
				<i class="bi bi-receipt-cutoff me-2"></i>Chi tiết đơn hàng <span
					th:text="'#' + ${order.id}"></span>
			</h3>
			<a href="/admin/orders" class="btn btn-sm btn-outline-secondary">
				<i class="bi bi-arrow-left me-1"></i> Quay lại danh sách
			</a>
		</div>
		<div th:if="${success}" class="alert alert-success"
			th:text="${success}"></div>
		<div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

		<div class="row g-4">
			<div class="col-lg-5">
				<div class="card mb-4">
					<div class="card-header bg-light">
						<h5 class="mb-0 fs-6 fw-bold text-secondary">
							<i class="bi bi-person-circle me-2"></i>Thông tin khách hàng
						</h5>
					</div>
					<div class="card-body info-group">
						<p>
							<strong>Khách hàng:</strong> <span
								th:text="${order.recipientName}"></span>
						</p>
						<p>
							<strong>Số điện thoại:</strong> <span
								th:text="${order.recipientPhone}"></span>
						</p>
						<p>
							<strong>Địa chỉ giao:</strong> <span
								th:text="${order.shippingAddress}"></span>
						</p>
						<p>
							<strong>Ghi chú:</strong> <span
								th:text="${order.note != null ? order.note : 'Không có'}"></span>
						</p>

					</div>
				</div>

				<div class="card">
					<div class="card-header bg-light">
						<h5 class="mb-0 fs-6 fw-bold text-secondary">
							<i class="bi bi-file-earmark-text me-2"></i>Thông tin đơn hàng
						</h5>
					</div>
					<div class="card-body info-group">
						<p>
							<strong>Mã đơn:</strong> <span th:text="'#' + ${order.id}"></span>
						</p>
						<p>
							<strong>Ngày đặt:</strong> <span
								th:text="${#temporals.format(order.orderDate,'dd/MM/yyyy HH:mm')}"></span>
						</p>
						<p>
							<strong>Thanh toán:</strong> <span
								th:text="${order.paymentMethod}"></span>
						</p>
						<p>
							<strong>Trạng thái:</strong>
						<form th:action="@{/admin/orders/update-status}" method="post"
							class="d-inline">
							<input type="hidden" name="orderId" th:value="${order.id}" /> <select
								name="status"
								class="form-select form-select-sm d-inline-block w-auto me-2">
								<option value="Đang xử lý"
									th:selected="${order.status=='Đang xử lý'}">Đang xử lý</option>
								<option value="Đang giao"
									th:selected="${order.status=='Đang giao'}">Đang giao</option>
								<option value="Hoàn tất"
									th:selected="${order.status=='Hoàn tất'}">Hoàn tất</option>
								<option value="Đã hủy" th:selected="${order.status=='Đã hủy'}">Đã
									hủy</option>
							</select>
							<button type="submit" class="btn btn-sm btn-primary">
								<i class="bi bi-check-circle me-1"></i> Cập nhật trạng thái
							</button>
						</form>
						</p>
					</div>
				</div>
			</div>

			<div class="col-lg-7">
				<div class="card">
					<div class="card-header bg-light">
						<h5 class="mb-0 fs-6 fw-bold text-secondary">
							<i class="bi bi-basket2 me-2"></i>Chi tiết sản phẩm
						</h5>
					</div>
					<div class="card-body p-0">
						<table class="table table-bordered align-middle m-0">
							<thead class="text-center table-light">
								<tr>
									<th>Sản phẩm</th>
									<th>Số lượng</th>
									<th>Đơn giá</th>
									<th>Thành tiền</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="detail : ${order.details}">
									<td class="ps-3" th:text="${detail.product.productName}"></td>
									<td class="text-center" th:text="${detail.quantity}"></td>
									<td class="text-center"
										th:text="${#numbers.formatDecimal(detail.price, 0, 'COMMA', 0, 'POINT')} + ' ₫'"></td>
									<td class="text-center"
										th:text="${#numbers.formatDecimal(detail.price.multiply(T(java.math.BigDecimal).valueOf(detail.quantity.longValue())), 0, 'COMMA', 0, 'POINT')} + ' ₫'"></td>

								</tr>
							</tbody>
							<tfoot>
								<tr class="table-light fw-bold">
									<td colspan="3" class="text-end pe-3">Tổng cộng:</td>
									<td class="text-center"
										th:text="${#numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 0, 'POINT')} + ' ₫'"></td>
								</tr>
							</tfoot>
						</table>
					</div>
				</div>
			</div>
		</div>

	</main>

</body>
</html>
